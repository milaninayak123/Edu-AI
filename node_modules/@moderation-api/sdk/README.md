# Moderation API Node.js library

The Moderation API Node library provides convenient access to the Stripe API from applications written in server-side JavaScript.

Use the Moderation API to analyze text and images for offensive content, profanity, toxicity, discrimination, sentiment, language and more - or detect, hide, and extract data entities like emails, phone numbers, addresses and more.

## Documentation

See the [`moderation-api-node` API docs](https://docs.moderationapi.com) for Node.js.

## Installation

Install the package with:

```sh
npm install @moderation-api/sdk
# or
yarn add @moderation-api/sdk
```

## Usage

The package needs to be configured with your projects's API key, which is
available in your [Project Dashboard](https://moderationapi.com/app/projects). Instantiate the client with your key:

<!-- prettier-ignore -->
```js
import ModerationAPi from '@moderation-api/sdk';

const moderationApi = new ModerationAPi({
  key: 'proj_...',
});

const analysis = await moderationApi.moderate.text({
  value: 'Hello world!',
})
console.log(analysis.flagged)
```

### Usage with TypeScript

The client works with TypeScript and is fully typed.

### Webhook signing

Moderation API can optionally sign the webhook events it sends to your endpoint, allowing you to validate that they were not sent by a third-party. You can read more about it [here](https://docs.moderationapi.com/review-queues/webhooks).

Please note that you must pass the _raw_ request body, exactly as received from Moderation API, to the `constructEvent()` function; this will not work with a parsed (i.e., JSON) request body.

Here's what it looks like using Next.js:

```js
import {buffer} from 'micro';

const handler = async (req, res) => {
  const webhookRawBody = await buffer(req);
  const webhookSignatureHeader = req.headers['modapi-signature'];

  const payload = await moderationApi.webhooks.constructEvent(
    webhookRawBody,
    webhookSignatureHeader,
    process.env.MODAPI_WEBHOOK_SECRET
  );
};

// disable body parser so we can access raw body
export const config = {
  api: {
    bodyParser: false,
  },
};

export default handler;
```

## Support

New features and bug fixes are released on the latest major version of the `@moderation-api/sdk` package. If you are on an older major version, we recommend that you upgrade to the latest in order to use the new features and bug fixes including those for security vulnerabilities. Older major versions of the package will continue to be available for use, but will not be receiving any updates.

## Email support

Reach out at [support@moderationapi.com](mailto:support@moderationapi.com)

## More Information

- [REST API Reference](https://docs.moderationapi.com/api-reference/introduction)
- [Rate limits](https://docs.moderationapi.com/api-reference/rate-limits)
- [Error Handling](https://docs.moderationapi.com/api-reference/errors)
- [Documentation](https://docs.moderationapi.com/get-started/introduction)
- [Test your API key](https://docs.moderationapi.com/api-reference/authentication)
